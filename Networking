https://net.cybbh.io/public/networking/latest/index.html
https://miro.com/app/board/o9J_klSqCSY=/?share_link_id=16133753693
http://networking-ctfd-1.server.vta:8000/user
RYVA-M-503



###FUNDAMENTALS
OSI model
-Physical
-Data Link   ###ARP
-Network   ###Routing protocols
-Transport   ###TCP, UDP
-Session   ###SOCKS, NetBIOS
-Presentation   ###How data is presented, ie.  JPEG, DOC
-Application   ###HTTPS, Telnet, IMAP, SSH

###Protocol Data Unit (PDU)
Physical = Bit
Data Link = Frame
Network = Packet
Transport = Segment / Datagram
Session-Application = Data

###Internet Standards Organizations
IETF - RFC's ###Request for comment
IANA - Internet Numbers ###Control IP's
IEEE - LAN/WAN electrical standards ###ie. 802.11

Binary, Hex conversion
Base64

###Topologies 
Bus   ###Half Duplex, can only communicate one way
Star   ###
Ring   ###
Mesh   ###Full and Partial
Wireless   ###
Hierarchial   ###

###Devices
Hubs   ###L1
Repeaters   ###
Switches   ###L2
Routers   ###L3

###Ethernet Timing (Bit-Time)
 Speed 	   Bit-time

10 Mbps  | 100ns

100 Mbps | 10ns

1 Gbps   | 1ns

10 Gbps  | .1ns

100 Gbps | .01ns



###Data Link Sub-Layers
MAC (Medium Access Control) 
LLC (Logical Link Control)

Encapsulation

###Switch Operation
Build Mac-Address (CAM) Table
Forwarding Frames

###Switching Modes
Cut-Through
Fragment-Free
Store-and-Forward

###CAM Table Overflow Attack
Send Frames with bogus sourse MAC address to switch
Cause switch to fill table with bogus addresses
Switch will not be able to learn new (valid) MAC addresses

###Describe MAC Addressing
Length: 48-bit | 6 byte | 12 Hex
Format:
 Windows: 01-23-45-12-34-56
 Unix/Linux: 01:23:45:12:34:56
 Cisco: 1234.1234.1234

###MAC Address Types
Unicast
Multicast
Broadcast

###Data Link frame headers
Destination (Only checked by cut through)
Source
Ethertype
Payload / Data / SDU
CRC / FCS

###VLAN
Logically seperate your network

###Trunk Link
Connects two switches (then you need STP)

###VLAN TYPES
Default - VLAN 1
Data - User traffic
Voice - VOIP traffic
Management - Switch and router managment
Native - Untagged switch and router traffic

802.1Q Header
802.1AD Header ###Double tagging, if a ISP wants to throw another tag on the header, 88 A8

###VLAN Hopping Attack
Switch Spoofing
Single Tagging
Double Tagging
SCAPY Example Code

###Address Resolution Protocol (ARP)
IP to MAC OR MAC to IP
###Types
ARP (OP 1 and 2)
RARP (OP 3 and 4)
Proxy ARP (OP 2)  ###Answers on a different network
Gratuitous ARP (OP 2)  ###Like a broadcast

###ARP CACHE
All resolved MAC to IP resolutions

###Man-In-The-Middle (MITM) With ARP
Poison ARP Cache with:
 Gratuitous ARP
 Proxy ARP
SCAPY Example Code

###VLAN Trunking Protocol (VTP)
Cisco Proprietory 
###VTP Vulnerablity 

###Dynamic Trunking Protocol (DTP)

###CDP, FDP, and LLDP
Cisco Discovery Protocol (CDP)
Foundry Discovery Protocol (FDP)
Link Layer Discovery Protocol (LLDP)
###Vulnerabilities
Clear Text (CDP Neighbor)
Enabled by default

###Spanning Tree Protocol (STP)
Prevents looping
1. Elect Root Bridge
2. Identify the Root ports on non-root bridge
3. Identify the Designated port for each segment

###Spanning Tree Attack
Crafted Bridge Protocol Data Units (BPDU)
Used to perform a DOS or MitM

###Port Security Modes
Shutdown (default)
Protect
Restrict

Restrict unauthorized access
Limit MAC address learned
prevents CAM attack

###Port Security Vulnerabilities
MAC Spoofing

###Layer 2 Attack Mitigation Techniques
Shutdown unused ports
Enable Port Security
IP Source Guard
Manually assign STP Root
BPDU Guard
DHCP Snooping
802.1x
Dynamic ARP inspection (DAI)
Static CAM entries
Static ARP entries
Disable DTP negotiations
Manually assign Access/Trunk ports




###NETWORK LAYER
Addressing Schemes for Network (Logical Addressing)

###Internet Protocol Versions
IPv4 (ARPANET 1982)
 Classful
 Classless subnetting (CIDR)
 NAT
IPv6 (Standardized 2017)

###Classful IPv4 Addressing and subnetting
Class A (0 to 127)
Class B (128 to 191)
Class C 
Class D
Class E

###Subnetting
IP addresses
 Network Portion
 Host Portion
Practoce of borrowing host bits for subnetting bits

###IPv4 Packet Header
https://net.cybbh.io/public/networking/latest/02_network/fg.html

###IPv4 Address Scopes
Public
Private (RFC 1918)
Loopback (127.0.0.0/8)
Link-Local (APIPA)
Multicast (Class D)

###IPv4 Fragmentation
Breaking up packets from higher MTU to lower MTU network
Performed by routers
MF flag is on from 1st until 2nd to last
Offset is on from 2nd until the last
Offset = (MTU - (IHL x 4)) / 8  ###IOT to calculate the fragment offset

###Fragmentation Process

###IPv6 Fragmentation
IPv6 does not support fragmentation within its header
Routers do not fragment IPv6 packets
Source adjusts MTU to avoid fragmentation

###Fragmentation Vulnerablities 
Can use fragmentation overlaps to avoid firewall detection
Attack depends on how 

APIPA RFC 3927
DHCP RFC

###IPv4 Auto Configuration Vulnerability 
Rogue DHCP
Evil Twin
DHCP Starvation ###Spams discover requests

###ICMPv4 Protocol and Header Structure

###ICMPv4 OS Fingerprinting 
Linux:
 Default size: 64 bytes
 Payload message:
Windows:
 Default size:
 Payload message:

###ICMPv4 Traceroute
Identifies hops between the source and destination
Uses incrementing TTLs

Can use various protocols and ports
 ICMP
 UDP
 TCP

###ICMPv4 Attacks
Firewalking (traceroute)
Oversized ICMP messages
ICMP Redirects
SMURF Attack
Map network w/ IP unreachables
ICMP Covert Channels

###IPv6 Addressing
128 bit address
64-bit Prefix
64-bit Interface ID
idk fast af

###IPv6 Subnetting
Organizations assign a 48-bit Prefix by IANA
Last 16-bits of the prefix are used for subnetting
fast af

###IPv6 Header

###IPv6 Representation
Can be shorten consecutive 0s with ::
Can only use it once

###IPv6 Address Types
Unicast 
Multicast
Anycast

###IPv6 Address Scopes
Global Unicast Addresses (2000::/3)
Unique Local (
finish later



###IPv6 Zero Configuration
Hosts request global prefix
 SLAAC (RFC 4862) (default)

###Dynamic Routing Protocols
Classful vs Classless
***Know the differences

###  Routed     vs          Routing Protocols
RIP, EIGRP, OSPF, BGP     IPv4, IPX, Appletalk, NetWare

###IGP and EGP
Autonomous system numbers

###Autonomous Systems

###Distance Vector Routing Protocols
Spread via rumor

###Link State Routing Protocols
LSA = Link state advertisment 

###Routing Protocol Vulnerabilities
DDOS, PMA

###BGP
Road-map of the internet
Routes traffic between AS Number
Advertises IP CIDR address block
Establishes Peer relationship

###BGP Operation

###BGP Hijacking
Illegitimate advertising

###BGP Hijacking Defense
IP prefix filtering

###Static Routing
Advantages
 Does not send updates
 No bandwidth used and minimal system resources
 Data path is pre-determined
Disadvantages
 Time consuming and prone to error in configuration
 Administrator must intervene during any network outages
 Does not scale well for large growing networks

###Dynamic Routing
Advantages
 Easier to configure
 Intervention not needed with outages
 Scales well for large networks
Disadvantages
 Consumes bandwidth
 Updates can be intercepted
 ahhhhhhhhhhhhh fg

###First Hop Redundancy Protocol

###OSI Layer 4 Ports
###Transport Layer Protocols
Connections-oriented
 tcp


###Port Ranges
0-1023 Well Known (System)
1024-49151 Registered (User)
49152-65535 Dynamic (Private)

###TCP Headers

###TCP Options
0
1
2
3
4 Selective ACK (SACK) Permitted
5 SACK
8 TCP Timestamps

###TCP Flag Breakout

###UDP Header
Source port
Destination Port
Length
Checksum

###Layer 5
